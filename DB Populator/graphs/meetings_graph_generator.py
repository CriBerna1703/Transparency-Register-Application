import pandas as pd

# Dati originali
data = [
    (1,1681),(2,702),(3,417),(4,257),(5,205),(6,148),(7,113),(8,120),
    (9,92),(10,68),(11,66),(12,69),(13,48),(14,38),(15,33),(16,46),
    (17,42),(18,28),(19,33),(20,33),(21,26),(22,22),(23,18),(24,19),
    (25,18),(26,20),(27,19),(28,17),(29,12),(30,17),(31,12),(32,15),
    (33,9),(34,12),(35,11),(36,12),(37,10),(38,6),(39,6),(40,7),(41,9),
    (42,9),(43,6),(44,10),(45,4),(46,4),(47,8),(48,6),(49,4),(50,6),(51,2),
    (52,3),(53,8),(54,8),(55,8),(56,5),(57,5),(58,5),(59,5),(60,2),(61,5),
    (62,5),(63,4),(64,3),(65,1),(66,5),(67,1),(69,1),(70,1),(71,2),(72,5),
    (74,4),(75,2),(76,4),(77,2),(78,2),(81,4),(82,4),(83,2),(84,2),(85,1),
    (87,2),(88,2),(89,1),(90,2),(91,1),(92,1),(93,3),(96,2),(98,2),(99,2),
    (100,2),(102,1),(103,2),(104,2),(105,1),(106,3),(110,1),(113,1),(115,1),
    (117,1),(118,1),(119,1),(121,1),(122,2),(129,1),(131,1),(132,1),(137,1),
    (140,1),(148,1),(159,1),(160,1),(164,1),(170,1),(171,1),(172,2),(184,1),
    (191,1),(193,1),(198,1),(202,1),(209,1),(220,2),(232,1),(252,1),(253,1),
    (277,1),(299,1),(362,1),(449,1)
]

# Creare un DataFrame
df = pd.DataFrame(data, columns=['num_meetings', 'num_lobbyists'])

# Definire i gruppi (binning)
bins = [0, 1, 2, 4, 7, 12, 20, 40, 100, 200, 500]
labels = ['1', '2', '3-4', '5-7', '8-12', '13-20', '21-40', '51-100', '101-200', '201-500']
df['meeting_group'] = pd.cut(df['num_meetings'], bins=bins, labels=labels)

# Raggruppare i dati per intervallo
grouped_data = df.groupby('meeting_group')['num_lobbyists'].sum().reset_index()

# Salvare in un file Excel o CSV
grouped_data.to_csv('meeting_distribution.csv', index=False)

# Stampa il risultato per verifica
print(grouped_data)
